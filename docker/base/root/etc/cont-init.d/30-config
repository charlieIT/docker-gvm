#!/usr/bin/with-contenv bash

# NOTE - based on https://github.com/linuxserver/docker-webgrabplus/blob/master/root/etc/cont-init.d/30-config
# The default cron schedule can be edited by mounting /config as a volume and tweaking the default file

# add cron file for running feed updates
[[ ! -e /config/update-cron ]] && \
	cp /defaults/update-cron /config/update-cron
crontab -u abc /config/update-cron

# ospd.conf
[[ ! -e /config/ospd.conf ]] && \
	cp /defaults/ospd.conf /config/ospd.conf

chown -R abc:abc \
	/config \
	/defaults \
	/usr/local/var/run \
	/usr/local/var/log \
	/usr/local/var/lib/gvm/gvmd

chown abc:abc \
	/usr/local/var/lib/openvas/plugins \
	/usr/local/var/lib/gvm/cert-data \
	/usr/local/var/lib/gvm/scap-data

#if [ ! -f "/usr/local/var/log/gvm/gvmd.log" ]; then
#	touch /usr/local/var/log/gvm/gvmd.log
#	chmod 666 /usr/local/var/log/gvm/gvmd.log
#fi